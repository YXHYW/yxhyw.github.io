"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2358],{47718:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var t=r(74848),s=r(28453);const i={sidebar_position:3,description:"Gin \u89e3\u6790\u8bf7\u6c42\u53c2\u6570"},l=void 0,a={id:"go/Gin/\u89e3\u6790\u8bf7\u6c42\u53c2\u6570",title:"\u89e3\u6790\u8bf7\u6c42\u53c2\u6570",description:"Gin \u89e3\u6790\u8bf7\u6c42\u53c2\u6570",source:"@site/docs/go/Gin/\u89e3\u6790\u8bf7\u6c42\u53c2\u6570.md",sourceDirName:"go/Gin",slug:"/go/Gin/\u89e3\u6790\u8bf7\u6c42\u53c2\u6570",permalink:"/docs/go/Gin/\u89e3\u6790\u8bf7\u6c42\u53c2\u6570",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"Gin \u89e3\u6790\u8bf7\u6c42\u53c2\u6570"},sidebar:"goSidebar",previous:{title:"\u6d4b\u8bd5",permalink:"/docs/go/Gin/\u6d4b\u8bd5"}},o={},c=[{value:"uri\u53c2\u6570",id:"uri\u53c2\u6570",level:2},{value:"\u67e5\u8be2\u53c2\u6570",id:"\u67e5\u8be2\u53c2\u6570",level:2},{value:"form\u8868\u5355\u53c2\u6570",id:"form\u8868\u5355\u53c2\u6570",level:2},{value:"JSON\u8bf7\u6c42\u4f53",id:"json\u8bf7\u6c42\u4f53",level:2},{value:"XML\u8bf7\u6c42\u4f53",id:"xml\u8bf7\u6c42\u4f53",level:2},{value:"\u4e0a\u4f20\u5355\u4e2a\u6587\u4ef6",id:"\u4e0a\u4f20\u5355\u4e2a\u6587\u4ef6",level:2},{value:"\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6",id:"\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6",level:2},{value:"\u8def\u7531\u7ec4",id:"\u8def\u7531\u7ec4",level:2}];function d(n){const e={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"uri\u53c2\u6570",children:"uri\u53c2\u6570"}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u901a\u8fc7Context\u7684Param\u65b9\u6cd5\u83b7\u53d6uri\u53c2\u6570."}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "net/http"\n    "strings"\n    "github.com/gin-gonic/gin"\n)\n\nfunc main(){\n    r := gin.Default()\n    r.GET("/user/:name/*action", func(c *gin.Context){\n        name := c.Param("name")\n        action := c.Param("action")\n\n        // \u622a\u53d6\n        action = strings.Trim(action, "/")\n        c.String(http.StatusOK, name + " is " + action)\n    })\n\n    r.Run("0.0.0.0:8001")\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6d4b\u8bd5\uff1a"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"curl http://192.168.0.10:8001/user/zhangsan/xuexi\n\n# zhangsan is xuexi\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u67e5\u8be2\u53c2\u6570",children:"\u67e5\u8be2\u53c2\u6570"}),"\n",(0,t.jsxs)(e.p,{children:["\u67e5\u8be2\u53c2\u6570\u53ef\u4ee5\u901a\u8fc7",(0,t.jsx)(e.code,{children:"DefaultQuery()"}),"\u6216",(0,t.jsx)(e.code,{children:"Query()"}),"\u65b9\u6cd5\u83b7\u53d6\u3002\u4f7f\u7528",(0,t.jsx)(e.code,{children:"DefaultQuery()"}),"\u65f6\uff0c\u82e5\u53c2\u6570\u4e0d\u5b58\u5728\uff0c\u8fd4\u56de\u9ed8\u8ba4\u503c\u3002\u4f7f\u7528",(0,t.jsx)(e.code,{children:"Query()"}),"\u65f6\uff0c\u5982\u679c\u53c2\u6570\u4e0d\u5b58\u5728\uff0c\u5219\u8fd4\u56de\u7a7a\u4e32\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "net/http"\n    "github.com/gin-gonic/gin"\n)\n\nfunc main(){\n    r := gin.Default()\n    r.GET("/user", func(c *gin.Context){\n        name := c.Query("name")\n        c.JSON(http.StatusOK, gin.H{\n            "hello": name,\n        })\n    })\n\n    r.Run("0.0.0.0:8001")\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6d4b\u8bd5\uff1a"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'curl http://192.168.0.10:8001/user?name=zhangsan\n\n# {"hello":"zhangsan"}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"form\u8868\u5355\u53c2\u6570",children:"form\u8868\u5355\u53c2\u6570"}),"\n",(0,t.jsx)(e.p,{children:"\u8868\u5355\u4f20\u8f93\u4e3a post \u8bf7\u6c42\uff0chttp \u5e38\u89c1\u7684\u4f20\u8f93\u683c\u5f0f\u6709\u56db\u79cd\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"application/json"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"application/x-www-form-urlencoded"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"application/xml"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"multipart/form-data"})}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "net/http"\n    "github.com/gin-gonic/gin"\n)\nfunc main(){\n    r := gin.Default()\n    r.POST("/form", func(c *gin.Context) {\n        username := c.PostForm("username")\n        password := c.PostForm("password")\n    }\n    c.JSON(http.StatusOK, gin.H{\n        "username": username,\n        "password": password,\n    })\n\n    r.Run("0.0.0.0:8001")\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"python\u6d4b\u8bd5"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import requests\n\ndata = {\n    "username": "zhangsan",\n    "password": "123456",\n}\n\nurl = "http://192.168.0.10:8001/v1/loginform"\n\nresp = requests.post(url, data = data)\nprint(resp.text)\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"curl\u6d4b\u8bd5\uff1a"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'curl -X POST -d \'username=zhangsan&password=123456\' http://192.168.0.10:8001/v1/loginform | python3 -m json.tool\n\n# {\n#     "password": "123456",\n#     "username": "zhangsan"\n# }\n'})}),"\n",(0,t.jsx)(e.h2,{id:"json\u8bf7\u6c42\u4f53",children:"JSON\u8bf7\u6c42\u4f53"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n\t"github.com/gin-gonic/gin"\n\t"net/http"\n)\n\n// \u5b9a\u4e49\u63a5\u6536JSON\u6570\u636e\u7684\u7ed3\u6784\u4f53\ntype Login struct {\n\tUsername string `json:"username" binding:"required"`\n\tPassword string `json:"password" binding:"required"`\n}\n\nfunc f1(c *gin.Context) {\n\tvar json Login\n\t// \u5c06\u6570\u636e\u89e3\u6790\u5230\u7ed3\u6784\u4f53\u4e2d\n\tif err := c.ShouldBindJSON(&json); err != nil {\n\t\t// \u8fd4\u56de\u9519\u8bef\u4fe1\u606f\n\t\tc.JSON(http.StatusBadRequest, gin.H{\n\t\t\t"error": err.Error(),\n\t\t})\n\t\treturn\n\t}\n\n\tc.JSON(http.StatusOK, gin.H{\n\t\t"Username": json.Username,\n\t\t"Password": json.Password,\n\t})\n}\n\nfunc f2(c *gin.Context) {\n\t// \u89e3\u6790\u672a\u77e5\u7ed3\u6784\u7684json\u8bf7\u6c42\u4f53\n\tvar jsonData map[string]interface{}\n\tif err := c.ShouldBindJSON(&jsonData); err != nil {\n\t\tc.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})\n\t\treturn\n\t}\n\t// \u4f7f\u7528 jsonData \u5904\u7406\u6570\u636e\n\tc.JSON(http.StatusOK, jsonData)\n}\n\nfunc main() {\n\tr := gin.Default()\n\tv1 := r.Group("/v1")\n\t{\n\t\tv1.POST("/loginjson", f1)\n\t\tv1.POST("/dynamicjson", f2)\n\t}\n\n\tr.Run("0.0.0.0:8000")\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"curl \u6d4b\u8bd5"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'curl -X POST \\\n-H \'Content-type:application/json\' \\\n-d \'{"username":"zhangsan","password": "qwerty"}\' \\\nhttp://127.0.0.1:8000/v1/loginjson\n\n# \u6d4b\u8bd5\u52a8\u6001\u8bf7\u6c42\u4f53\ncurl -X POST http://127.0.0.1:8000/v1/dynamicjson -d \'{"username": "zhangsan", "password": "123456"}\'\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"python - requests\u6d4b\u8bd5"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import json\nimport requests\n\ndata_json = {\n    "username": "zhangsan",\n    "password": "123456",\n}\n\nurl = "http://192.168.0.10:8000/v1/loginjson"\n\nresp = requests.post(url, data = json.dumps(data_json))\nprint(resp.text)\n'})}),"\n",(0,t.jsx)(e.h2,{id:"xml\u8bf7\u6c42\u4f53",children:"XML\u8bf7\u6c42\u4f53"}),"\n",(0,t.jsx)(e.p,{children:"2023\u5e74\u4e86\uff0c\u4e0d\u4f1a\u8fd8\u6709\u7528XML\u505a\u8bf7\u6c42\u4f53\u7684\u5427\uff1f\u4e0d\u4f1a\u5427\uff1f"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"go\u4ee3\u7801"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'func f4(c *gin.Context){\n    // xml\u6570\u636e\u89e3\u6790\u4e0e\u7ed1\u5b9a\n    var xml Login\n    // \u5c06\u6570\u636e\u89e3\u6790\u5230\u7ed3\u6784\u4f53\u4e2d\n    if err := c.ShouldBindXML(&xml); err != nil {\n        // \u8fd4\u56de\u9519\u8bef\u4fe1\u606f\n        c.JSON(http.StatusBadRequest, gin.H{\n            "error": err.Error(),\n        })\n        return\n    }\n\n    c.JSON(http.StatusOK, gin.H{\n        "Username": xml.Username,\n        "Password": xml.Password,\n    })\n}\n\nv1.POST("/loginxml", f4)\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"python - requests \u6d4b\u8bd5"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import requests\n\ndata_xml = """\n<?xml version="1.0" encoding="utf-8"?>\n<server>\n<username>lisi</username>\n<password>123456</password>\n</server>\n"""\n\nurl = "http://192.168.0.10:8001/v1/loginxml"\n\nresp = requests.post(url, data = data_xml)\nprint(resp.text)\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u4e0a\u4f20\u5355\u4e2a\u6587\u4ef6",children:"\u4e0a\u4f20\u5355\u4e2a\u6587\u4ef6"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"multipart/form-data"}),"\u683c\u5f0f\u7528\u4e8e\u6587\u4ef6\u4e0a\u4f20"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "fmt"\n    "log"\n    "net/http"\n    "github.com/gin-gonic/gin"\n)\n\nfunc main() {\n        r := gin.Default()\n        // \u4e3a multipart forms \u8bbe\u7f6e\u6587\u4ef6\u5927\u5c0f\u9650\u5236, \u9ed8\u8ba4\u662f32MB\n        // \u6b64\u5904\u4e3a\u5de6\u79fb\u4f4d\u8fd0\u7b97\u7b26, 8 * 2\u768420\u6b21\u65b9\n        r.MaxMultipartMemory = 8 << 20  // 8 MiB\n        r.POST("/upload", func(c *gin.Context) {\n                // \u5355\u6587\u4ef6\n                file, _ := c.FormFile("file")\n                log.Println(file.Filename)\n\n                // \u4e0a\u4f20\u6587\u4ef6\u81f3\u6307\u5b9a\u7684\u5b8c\u6574\u6587\u4ef6\u8def\u5f84\n                dst := "./" + file.Filename\n                c.SaveUploadedFile(file, dst)\n\n                c.String(http.StatusOK, fmt.Sprintf("\'%s\' uploaded!", file.Filename))\n        })\n        r.Run("192.168.0.10:8001")\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6d4b\u8bd5:"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"curl -X POST 'http://192.168.0.10:8001/upload' -F \"file=@./abc.txt\" -H \"Content-Type: multipart/form-data\"\n\n# 'abc.txt' uploaded!\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6",children:"\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "fmt"\n    "log"\n    "net/http"\n    "github.com/gin-gonic/gin"\n)\n\nfunc UploadMultiFile(c *gin.Context){\n    // \u591a\u6587\u4ef6\n    form, _ := c.MultipartForm()\n    files := form.File["upload[]"]\n    for _, file := range files {\n        log.Println(file.Filename)\n        // \u4e0a\u4f20\u6587\u4ef6\u81f3\u6307\u5b9a\u7684\u5b8c\u6574\u6587\u4ef6\u8def\u5f84\n        savePath := "./" + file.Filename\n        c.SaveUploadedFile(file, savePath)\n    }\n\n    c.String(http.StatusOK, fmt.Sprintf("%d files uploaded!", len(files)))\n}\n\nfunc main() {\n    r := gin.Default()\n    // \u4e3a multipart forms \u8bbe\u7f6e\u6587\u4ef6\u5927\u5c0f\u95f2\u7f6e \u9ed8\u8ba4\u662f32MB\n    // \u6b64\u5904\u4e3a\u5de6\u79fb\u4f4d\u8fd0\u7b97\u7b26, 8 * 2\u768420\u6b21\u65b9\n    r.MaxMultipartMemory = 8 << 20  // 8 MiB\n    r.POST("/uploads", UploadMultiFile)\n\n    r.Run("192.168.0.10:8001")\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6d4b\u8bd5\uff1a"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'curl -X POST \'http://192.168.0.10:8001/uploads\' -F "upload[]=@./abc.txt" -F "upload[]=@./bcd.txt" -F "upload[]=@./cde.txt" -H "Content-Type: multipart/form-data"\n\n# 3 files uploaded!\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u8def\u7531\u7ec4",children:"\u8def\u7531\u7ec4"}),"\n",(0,t.jsx)(e.p,{children:"\u8def\u7531\u7ec4\u7528\u4e8e\u7ba1\u7406\u4e00\u4e9b\u76f8\u540c\u7684url\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "net/http"\n    "github.com/gin-gonic/gin"\n)\n\nfunc Hello(c *gin.Context){\n    name := c.Param("name")\n\n    c.JSON(http.StatusOK, gin.H{\n        "hello": name,\n    })\n}\n\nfunc main() {\n    r := gin.Default()\n    v1 := r.Group("/v1")\n    {\n        v1.GET("/user/:name", Hello)\n    }\n    v2 := r.Group("/v2")\n    {\n        v2.GET("/user/:name", Hello)\n    }\n\n        r.Run("192.168.0.10:8001")\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6d4b\u8bd5\uff1a"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"curl http://192.168.0.10:8001/v1/user/zhangsa\ncurl http://192.168.0.10:8001/v2/user/lisi\n"})})]})}function u(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},28453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>a});var t=r(96540);const s={},i=t.createContext(s);function l(n){const e=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),t.createElement(i.Provider,{value:e},n.children)}}}]);